================================================================================
OXIDE-SQL DJANGO-LIKE FRAMEWORK IMPLEMENTATION PLAN
================================================================================

This document outlines the remaining work to complete the Django-like features
for the oxide-sql framework. Use this to continue implementation in a new
Claude Code session.

================================================================================
CURRENT STATUS
================================================================================

COMPLETED:
---------
1. oxide-orm (mostly complete)
   - src/lib.rs
   - src/error.rs
   - src/model.rs
   - src/manager.rs
   - src/queryset.rs
   - src/query/mod.rs
   - src/query/filter.rs (Q objects)
   - src/query/aggregates.rs
   - src/fields/mod.rs
   - src/fields/char.rs
   - src/fields/numeric.rs
   - src/fields/temporal.rs
   - src/fields/boolean.rs
   - src/fields/relations.rs

2. oxide-auth (complete)
   - src/lib.rs
   - src/error.rs
   - src/password.rs (Argon2 hashing)
   - src/user.rs
   - src/session.rs
   - src/permissions.rs
   - src/backends/mod.rs
   - src/backends/database.rs

3. oxide-forms (complete)
   - src/lib.rs
   - src/error.rs
   - src/form.rs
   - src/validation.rs
   - src/widgets/mod.rs
   - src/widgets/bootstrap.rs
   - src/fields/mod.rs
   - src/fields/text.rs
   - src/fields/select.rs
   - src/fields/checkbox.rs
   - src/fields/hidden.rs

4. oxide-router (complete)
   - src/lib.rs
   - src/error.rs
   - src/request.rs
   - src/response.rs
   - src/path.rs
   - src/middleware.rs
   - src/router.rs

5. oxide-admin (partially complete)
   - Cargo.toml
   - src/error.rs
   - src/templates/mod.rs
   - src/templates/base.rs (Bootstrap 5 layout)
   - src/templates/list.rs (list view template)
   - src/templates/detail.rs (detail/edit view template)

REMAINING WORK:
--------------

================================================================================
PHASE 1: COMPLETE OXIDE-ADMIN
================================================================================

1. Create src/options.rs (ModelAdmin configuration)
   ```rust
   - ModelAdmin struct with builder pattern
   - Fieldset struct for field grouping
   - InlineAdmin for related model editing
   - Action trait for bulk actions
   - ActionResult struct
   ```

2. Create src/site.rs (AdminSite registration)
   ```rust
   - AdminSite struct
   - Model registration methods
   - Route generation
   - URL prefix configuration
   ```

3. Create src/views/mod.rs
   ```rust
   - Re-export all view handlers
   ```

4. Create src/views/index.rs (Dashboard)
   ```rust
   - index_view handler
   - Shows registered models
   - Recent actions (optional)
   ```

5. Create src/views/list.rs (Changelist view)
   ```rust
   - list_view handler
   - Pagination logic
   - Search logic
   - Filter logic
   - Sorting logic
   ```

6. Create src/views/detail.rs (Add/Change view)
   ```rust
   - add_view handler
   - change_view handler
   - Form generation
   - Validation
   - Save logic
   ```

7. Create src/views/delete.rs (Delete confirmation)
   ```rust
   - delete_view handler
   - Confirmation page
   - Actual deletion
   ```

8. Create src/actions.rs (Built-in actions)
   ```rust
   - DeleteSelectedAction
   - Other common actions
   ```

9. Create src/filters.rs (List filters)
   ```rust
   - Filter trait
   - BooleanFilter
   - ChoicesFilter
   - DateRangeFilter
   ```

10. Create src/lib.rs
    ```rust
    - Re-export all public types
    - Module declarations
    ```

================================================================================
PHASE 2: WORKSPACE CONFIGURATION
================================================================================

The workspace Cargo.toml has been updated with all crate paths.
Verify all crates compile:

```bash
cargo check --workspace
cargo clippy --workspace -- -D warnings
cargo fmt --all -- --check
cargo test --workspace
```

================================================================================
PHASE 3: PLAYWRIGHT E2E TESTS
================================================================================

1. Create e2e/ directory structure:
   ```
   e2e/
     package.json
     playwright.config.ts
     tests/
       admin.spec.ts
       auth.spec.ts
       crud.spec.ts
   ```

2. package.json dependencies:
   ```json
   {
     "devDependencies": {
       "@playwright/test": "^1.40.0",
       "typescript": "^5.0.0"
     }
   }
   ```

3. Test scenarios to implement:
   - Login/logout flow
   - List view with pagination
   - Search functionality
   - Filter functionality
   - Create new object
   - Edit existing object
   - Delete object
   - Bulk actions
   - Inline editing

================================================================================
PHASE 4: BLOG ADMIN EXAMPLE
================================================================================

Create examples/blog_admin.rs demonstrating:

1. Define models:
   ```rust
   struct Post { id, title, slug, content, status, author_id, created_at }
   struct Comment { id, post_id, author, content, created_at }
   struct Tag { id, name, slug }
   struct PostTag { post_id, tag_id }  // Many-to-many junction
   ```

2. Create migrations

3. Set up AdminSite:
   ```rust
   let admin = AdminSite::new("Blog Admin")
       .register::<Post>(
           ModelAdmin::new()
               .list_display(&["id", "title", "status", "created_at"])
               .list_filter(&["status"])
               .search_fields(&["title", "content"])
               .ordering(&["-created_at"])
               .fieldset(Fieldset::named("Content", &["title", "slug", "content"]))
               .fieldset(Fieldset::named("Publishing", &["status", "author_id"]).collapse())
       )
       .register::<Comment>(
           ModelAdmin::new()
               .list_display(&["id", "post_id", "author", "created_at"])
       )
       .register::<Tag>(
           ModelAdmin::new()
               .list_display(&["id", "name", "slug"])
       );
   ```

4. Set up HTTP server (using tokio + hyper or axum)

5. Run and test

================================================================================
MAKEFILE TARGETS
================================================================================

Add to Makefile:

```makefile
.PHONY: e2e-install
e2e-install: ## Install E2E test dependencies
	cd e2e && npm install && npx playwright install

.PHONY: e2e-test
e2e-test: ## Run E2E tests
	cd e2e && npx playwright test

.PHONY: e2e-test-ui
e2e-test-ui: ## Run E2E tests with UI
	cd e2e && npx playwright test --ui

.PHONY: example-blog
example-blog: ## Run blog admin example
	cargo run --example blog_admin
```

================================================================================
KEY FILES TO CREATE
================================================================================

1. crates/oxide-admin/src/options.rs
2. crates/oxide-admin/src/site.rs
3. crates/oxide-admin/src/views/mod.rs
4. crates/oxide-admin/src/views/index.rs
5. crates/oxide-admin/src/views/list.rs
6. crates/oxide-admin/src/views/detail.rs
7. crates/oxide-admin/src/views/delete.rs
8. crates/oxide-admin/src/actions.rs
9. crates/oxide-admin/src/filters.rs
10. crates/oxide-admin/src/lib.rs
11. e2e/package.json
12. e2e/playwright.config.ts
13. e2e/tests/admin.spec.ts
14. examples/blog_admin.rs

================================================================================
COMMANDS TO RESUME
================================================================================

In new Claude Code session, say:

"Continue implementing the oxide-sql Django-like framework. Read
IMPLEMENTATION_PLAN.txt for current status and remaining work. Start with
completing oxide-admin/src/options.rs"

================================================================================
